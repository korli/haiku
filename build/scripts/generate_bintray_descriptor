#!/bin/sh -vx

targetArch=x86_64

cat > generated/bintray.json << EOF
{
    "package": { 
        "name": "haiku.images",
        "repo": "haiku_images",
        "subject": "korli"
    },
    "version": {
        "name": "$(date --iso-8601)",
        "released": "$(date --iso-8601=seconds)"
    },
    "files":
        [
        {"includePattern": "generated/(haiku.*)", "uploadPattern": "$TRAVIS_COMMIT/$targetArch/\$1"}
        ],
    "publish": true
}
EOF

echo "generated descriptor:"
cat generated/bintray.json
echo "list of files to be uploaded:"
ls -l generated/haiku*
xz generated/haiku*
ls -l generated/haiku*
echo "done"
